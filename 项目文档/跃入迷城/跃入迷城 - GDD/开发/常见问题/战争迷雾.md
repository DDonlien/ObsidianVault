
**战争迷雾**

**我想给场景添加战争迷雾**

- 场景中放置一个BP\_FogOfWarMask，z和地平面z相同，XY为场景中心。记得把Yaw设为-90。
- 主体角色添加LineOfSightComponent，attach到根组件（例如Character的胶囊体）
- 这两个类有一些参数，在Property里搜ProjFiber就能找到
- 可以参考L\_Playground，里面有一整套搭建好的战争迷雾

**Actor和战争迷雾交互（视野外隐藏/Freeze）**

- 添加FOWActorComponent并实现IFOWInterface接口，这样一个Actor就认为参与到FOW交互中

![...](../../../跃入迷城%20-%20GDD/开发/常见问题/images/战争迷雾.001.png)

![...](../../../跃入迷城%20-%20GDD/开发/常见问题/images/战争迷雾.002.png)

- 实现IFOWInterface的函数，目前有

![...](../../../跃入迷城%20-%20GDD/开发/常见问题/images/战争迷雾.003.png)

- GetMeshes: 指定Actor的MeshComponent，应对每个对象不同的组件结构
- GetBoundingRadius: 指定角色XY平面的半径，防止迷雾以Actor原点为出现/消失的分界点，而是整个Mesh出去后才消失。可以不实现，那样半径就是0
- SetVisibilityToFOW(bool InVisiblity) : 角色出/入视野时的回调（入参分别为false/true），不同类型Actor可能需要不同行为，例如怪物出视野时Mesh/子对象/血条等消失，而物品等出视野不消失，只是动画停止播放
- Note:
- 现在默认所有参与FOW的Actor初始时都不可见，后续会考虑开放不同逻辑开关

**战争迷雾效果调整**

目前开放了三个滑块，可以在BP\_FogOfWarMask中找到（Instance可编辑）

![...](../../../跃入迷城%20-%20GDD/开发/常见问题/images/战争迷雾.004.png)

- Trail Alpha: 已探索视野外区域的亮度
- Unveiled Alpha: 未探索区域的亮度
- Height Threshold: 高度阈值，超过这个高度的水平面永远未探索
- Note: 这两个亮度调节都略反直觉，可能要把滑块拉到很低才能有一个相对暗的结果，可能由某些奇怪的HDR/亮度特性导致，如果现在的数值精度无法达到要求可以找@Decay
- Note2: LOS和FOW的有所数值都不要尝试运行时修改

