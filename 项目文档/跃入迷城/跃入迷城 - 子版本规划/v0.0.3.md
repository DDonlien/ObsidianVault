
**v0.0.3**

**v0.0.2复盘**

**主要更新**

**玩法**

1. 调整了近战和远程攻击机制：射击时的减速效果以及近战攻击时的动作和移动调整会大幅优化战斗节奏
2. 调整了关卡刷新逻辑：现在游戏可以自由的设计关卡的起点与终点，并且基于此设计追加了2个关卡场景
3. 墙壁的透视效果生效，现在玩家能正确的看到墙后的自己和敌人
4. 调整了战争迷雾的跟随逻辑，现在迷雾会有一个非常小角度的死区，优化了观察场景的手感
5. 义体打印机已经完成，玩家可以在游戏中获取义体，但后续可能还有进一步调整
6. 追加了敌人的掉落系统和信用点系统，玩家现在可以从敌人身上拾取到资源了，并且购买升级也会消耗相应的资源
7. 敌人死亡后现在会在地上保留显示尸体，提升场景代入感
8. 移除了电梯卡概念，现在玩家清版后可以直接前往下一楼层
9. 部分完善了AI功能，但暂时还以底层为主，玩法感知较弱

**视觉**

1. 追加了风格化Shader，主要以工程实现为目的，后续会逐步调优视觉效果
2. 追加了新的UI，尝试围绕玩家展示UI信息，其他不同的UI设计风格还在尝试中

**工程**

1. 大量优化和框架迁移
1. 迁移到CommonUI
2. 接入了Wwise

**问题**

**项目管理**

1. 任务分配的**层级不明确**：我们应该更专注于切片需要交付的“底层功能”以及“核心功能”的打磨，而非平行的在所有切片内容上努力，以避免测试2级、3级功能时候失去基准
2. **任务描述语焉不详**、来源不稳定：后续版本迭代一律按照“在版本文档里撰写需求” -> “转为任务”进行管理，并且确保每个任务光看标题（最多加上描述）知道要做什么
3. 大幅高估了项目推进进程，主要是在前期规划期间对sprint的规模（包含的任务）评估不够可靠导致
4. 根据v0.0.2的情况来看，我们大约可以在一个迭代（6周）的时间内完成40个左右的task，如果人员稳定性和数量更理想、项目目标更明确，则这个数字有机会上升
1. @Taobe需要在迭代周期开始前就尽可能完整地准备好任务

**程序**

1. AI的基础功能（各种响应）有些反复，有时候一个功能fix了另一个又出问题，也许是模块化剥离的不彻底？因为至少从直观上感觉几个功能是比较孤立的。

**玩法**

1. 游戏本身作为一款俯视角射击游戏，目前**暂时还并不好玩**
1. 射击手感和反馈太弱
2. 敌人缺少趣味性和挑战性

**v0.0.3规划**

**思路**

1. 在《跃入迷城》是一个“roguelike”游戏、“魂like”游戏、“赛博朋克”游戏之前，首先它得是一个**好玩的“俯视角射击”游戏**
1. 把游戏所有和**俯视角射击控制**打磨到生产质量
1. 包括手感、动画、**硬直冲击力系统**
1. 手感可能和镜头抖动有关，目前的输入逻辑本身没有问题
2. 不包括数值和技能
1. 玩家即使只能当作俯视角版本的COD玩，游戏也应该很有趣
- ~~把**基础AI**打磨到生产质量~~
1. 包括AI逻辑、Sensor
2. 不包括数值和技能
1. AI即使只能攻击，应该也能很有趣的和玩家进行交互
2. 优化必须的相关系统，比如**镜头**
3. 很多任务可能会变得更琐碎，比如我没有办法给出一个完整的音效需求列表，但会更具体，比如我很明确需要一个足够好的走路、跑步音效
2. 尽可能高效的推进和玩法不关联的项目进度
1. 美术：推进风格化美术的定调和落地
2. 剧情：推进剧本撰写
3. UI：尽量在Prototype、Sketch层面定调UI
4. 前提是开发资源不重叠
3. 对以上两点进行必要的其他模块支持
1. 比如为了提升操作手感可能需要**SFX**、**VFX**
4. **关卡、Build和Looping**会放到射击控制部分合格了以后进行处理

**目标**

- ~~切换动画框架到Lyra，优化战斗动作动画~~
1. 调整操作手感 -> 动画相关
2. 切换到Lyra会导致动画资产需要切换
1. 举例来说：一个Lyra的移动动作包含启动、运动（循环）、停止之类的切换步骤
2. 基于Lyra基础定制，删除某些逻辑（比如起步之类，我们没那么复杂的动画，而且这样手感可能更好）
3. 优点：性能、细节
- ~~优化AI响应逻辑~~

**玩法**

**硬直**

**定义**

硬直、冲击、韧性系统这里放到一起研究，参考如下：

- https://www.gcores.com/articles/136479

为了便于交流，简单定义一下这3个概念：

**硬直**：使角色处于**不可控状态**的**事件**

- 这里有几个重点值得展开：
- 角色：一般我们认为硬直事件只作用于角色，因为只有角色在游戏中有“控制”能力，这里可以详见UE里对于Pawn和Actor定义的区别
- 不可控状态：硬直的另一大特性，无论多短，角色会在一定时间/帧数内变的不可控。
- 事件：硬直是一个事件，而非一个状态（尽管它产生了一个不可控状态）。
- 事件和状态的区别可以用一个简单的例子区分：
- 翻滚显然是一个事件，它有一个明确的动作序列，在固定的时间段内实现一次并终止，角色一般也无法在翻滚期间打断翻滚或再次进行翻滚；
- 而奔跑是一个状态，玩家可以很自由的切换奔跑状态，并且也可以无限的（资源允许的话）维持在奔跑状态。
- 硬直事件可以是主动的（前后摇）或者被动的（受击）。但从游戏设计的角度来说，两者关注的点会有不少差异（尤其是我没有在做格斗游戏的话）。

**冲击**：造成角色**硬直**的**事件**被定义为冲击**事件**，**冲击**的强度**属性**被定义为**冲击力**

- 几乎“所有”事件都可以触发、或被视作冲击事件，比如受伤、坠落、碰撞；也几乎所有属性都可以转为冲击力，比如伤害、坠落高度、重量

**韧性**：抵抗**冲击事件**的一种**角色属性**

- 韧性可以和冲击力、伤害或者任何其他属性互动来实现抵抗逻辑，此时，这些属性从功能上间接实现了冲击力属性的功能。但韧性仅会在冲击事件发生时处理这种逻辑。
- 韧性虽然是一种属性，但未必是数值化的。事实上大部分韧性都是“类型化”的，比如“霸体”就是一种韧性类型，也即角色不响应任何冲击事件。
- 大部分有动作元素的游戏，都会极其频繁的调整主控角色的韧性，举例来说：角色在攻击动作期间会有相对于常态显著更高的韧性，而如果是冷兵器为主的游戏，则往往武器越“重”这种韧性的提升程度越大。

**设计思路 @Decay@Cade**

显然我们不需要像黑魂、老头环这么复杂的硬直系统，保留以下几个方面预计需要实现

- ~~构建硬直系统@Decay⏰2024-12-04 08:00~~
- **处理逻辑**
- 造成冲击时先判断韧性消减，如果归零，进入大硬直事件
- 如果没有归零，判断冲击等级是否大于韧性等级，如果没有，无事发生
- 如果冲击等级大于韧性等级，根据冲击附带的冲击事件触发对应的硬直事件
- 韧性 < 0后应该进入一个“免疫削韧”的情况，直至“韧性回满后 + {x}秒”
- 韧性事件的动画应该形如攻击动画蒙太奇：有一个可以决定何时可以播放下一个蒙太奇的Tag

![...](../跃入迷城%20-%20子版本规划/images/v0.0.3.001.jpeg)

- **硬直事件**
- **硬直系统**（PosieComponent）调用**硬直事件**（StunEvent），硬直事件包含属性和多种动画
- 每个角色应该有所有可用的StunEvent，但具体Event本身可以是没有效果的

```<p>- StunEvent的父类至少应该包含以下内容</p><p>- 打断动作 = True/False</p><p>- 无敌 = True/False</p><p>- 无敌期间也不会受到韧性伤害</p><p>- 持续时间 = {float}秒</p><p>- 动画蒙太奇 = {object}</p>```
- 游戏中有以下类型的硬直事件，可以继承并附加到不同角色
- **StunEvent\_None**
- 不打断动作
- 持续{0}秒
- 无动画
- 用于实现霸体
- **StunEvent\_S**
- 打断动作
- 持续{X}秒
- 简单**快速**的受打击动画
- 用于处理被**普通攻击**打断当前动作的情况
- **StunEvent\_M**
- 打断动作
- 持续{X}秒
- 简单**沉重**的受打击动画
- 用于处理被**重攻击**打断当前动作的情况，或者表现**韧性超低**的角色
- **StunEvent\_L**
- 打断动作
- 持续{X}秒
- 复杂**沉重**的受打击动画，例如下跪
- 用于处理被**重攻击**打断当前动作的情况，或者表现**韧性值清空**（血源敌人被枪反时）的状态
- **StunEvent\_Push**
- 打断动作
- 持续{X}秒
- 击退然后倒地的动画
- 用于处理有**击退冲击力**的攻击打断当前动作的情况
- 应当将角色转向到受击方向，以避免奇怪的背身飞行情况
- **StunEvent\_Blow**
- 打断动作
- 持续{X}秒
- 击飞然后倒地的动画
- 用于处理有**击飞冲击力**的攻击打断当前动作的情况
- 应当将角色转向到受击方向，以避免奇怪的背身飞行情况
- **冲击事件**
- 冲击系统（ImpactComponent）调用**冲击事件**，并且定义**削韧值**和**冲击等级**
- 冲击事件的新计算方法@Decay
- 武器冲击力 - 角色韧性等级 = X
- X = 触发韧性事件的列表Index
- X = 0; None
- X = 1; Small
- X = 2; Mid
- X = 3; Large
- X > 3; Special，用名称匹配
- 武器、技能附带冲击系统，假想的结构如下

```<p>- ID\_Weapon</p><p>- ImpactComponent</p><p>- PosieDamage = {float}</p><p>- 削韧值</p><p>- ImpactLevel = {int}</p><p>- 冲击等级</p><p>- ImpactType = {list}</p><p>- List = ImpactEvent[None,S,M,L]</p><p>- 每个武器只有1个ImpactType，应该是一个下拉选单</p>```
- **韧性系统**
- **韧性系统**（PoiseComponent）附加到**角色Character**，定义**韧性等级、韧性值和韧性回复率，假象的结构如下**

```<p>- BP\_Character</p><p>- PosieComponent</p><p>- Posie = {float}</p><p>- 韧性值</p><p>- PosieRegain = {float}/sec</p><p>- 韧性值回复率</p><p>- PosieRegainWait = {float}</p><p>- 韧性回复间隔</p><p>- PosieLevel = {int}</p><p>- 韧性等级</p><p>- StunEvent= {list}</p><p>- 每个角色有全部的StunEvent，应该是一个双对象的MappingList，对如下4个Event声明选择对应的实际Event</p><p>- StunEvent[None] = StunEvent\_?</p><p>- StunEvent[S] = StunEvent\_?</p><p>- StunEvent[M] = StunEvent\_?</p><p>- StunEvent[L] = StunEvent\_?</p>```
- **额外规则**
- 如没有特殊描述，所有武器的**冲击等级** = 1
- 如没有特殊描述，所有小怪的**韧性等级** = 0
- ~~基于护甲值的硬直变动：有护甲的单位韧性等级 + 1@Decay⏰2024-12-25 08:00~~
- 这应该是实时变化的，所以在角色配置里不考虑由护甲带来的韧性等级

**实际任务**

- ~~为武器{ID}添加冲击力系统ImpactComponent~~
- ~~为武器{ImpactComponent}添加属性ImpactLevel，决定武器的冲击力等级~~
- ~~为武器{ImpactComponent}添加属性ImpactEvent，决定武器触发的冲击力事件~~
- ~~为武器{ImpactComponent}添加属性PoiseDamage，决定武器造成的韧性伤害~~

```<p>- ID\_Weapon</p><p>- ImpactComponent</p><p>- PosieDamage = {float}</p><p>- 削韧值</p><p>- ImpactLevel = {int}</p><p>- 冲击等级</p><p>- ImpactType = {list}</p><p>- List = ImpactEvent[None,S,M,L]</p><p>- 每个武器只有1个ImpactType，应该是一个下拉选单</p><p>
同步自文档: <https://dikpa4hrtn9.feishu.cn/docx/NegZdhG0toih86xQru5c0DXLnxb#GCLOdWeJXsRWnebHbU8cYAjXnIf></p>```
- 为角色{BP\_Character}添加韧性系统PosieComponent
- 为角色{PosieComponent}添加属性Posie
- 为角色{PosieComponent}添加属性PosieRegain
- 为角色{PosieComponent}添加属性PosieRegainWait
- 为角色{PosieComponent}添加属性PosieLevel

```<p>- BP\_Character</p><p>- PosieComponent</p><p>- Posie = {float}</p><p>- 韧性值</p><p>- PosieRegain = {float}/sec</p><p>- 韧性值回复率</p><p>- PosieRegainWait = {float}</p><p>- 韧性回复间隔</p><p>- PosieLevel = {int}</p><p>- 韧性等级</p><p>- StunEvent= {list}</p><p>- 每个角色有全部的StunEvent，应该是一个双对象的MappingList，对如下4个Event声明选择对应的实际Event</p><p>- StunEvent[None] = StunEvent\_?</p><p>- StunEvent[S] = StunEvent\_?</p><p>- StunEvent[M] = StunEvent\_?</p><p>- StunEvent[L] = StunEvent\_?</p><p>
同步自文档: <https://dikpa4hrtn9.feishu.cn/docx/NegZdhG0toih86xQru5c0DXLnxb#VQQRdEMVysl7k8bdPzGcRFx8nvg></p>```
- 创建StunEvent父类

```<p>- StunEvent的父类至少应该包含以下内容</p><p>- 打断动作 = True/False</p><p>- 无敌 = True/False</p><p>- 无敌期间也不会受到韧性伤害</p><p>- 持续时间 = {float}秒</p><p>- 动画蒙太奇 = {object}</p><p>
同步自文档: <https://dikpa4hrtn9.feishu.cn/docx/NegZdhG0toih86xQru5c0DXLnxb#XUd0dkjRBsNSItbJEqBcvhTqngc></p>```
- ~~先实现“受到攻击后打断当前动作，在{X}秒内播放受击动画，然后恢复控制”@Decay⏰2024-12-04 08:00~~

**镜头**

- 翻滚的动画衔接异常还导致一个很难受的问题：
- ~~镜头似乎是follow胶囊体中心的，应当改为always追踪胶囊体的某个固定位置（中央）高度而不随胶囊体本身变化@Decay⏰2024-11-10 08:00~~
- 这导致非常令人不适的上下抖动
- 我也考虑过追踪脚底，可能也是个办法，可以的话都试一下

**延迟**

- ~~在翻滚时增加一个镜头位移延迟@Decay⏰2024-11-12 08:00~~
- 翻滚时镜头应该延迟启动移动（感受上差不多应该翻滚完了再移动）然后可以直接继续用Spring Arm的延迟过度

**抖动**

- ~~添加镜头抖动系统{CameraShakeEvent}@Decay⏰2024-11-27 08:00~~
- ~~确定镜头抖动事件的封装结构~~
- 是个GameplayCue，GAS会把客户端处理的内容都封装到GC，例如动画
- ~~为镜头抖动提供几个可配置参数~~
- 持续时间
- 抖动强度
- 显然我们应该对X、Y两个轴向（Camera局部坐标）分别设计抖动强度
- 但抖动强度是一条关于时间和速度/位移的曲线（GPT推荐），还是一个作用在Camera的力，我并没有特别的想法，可能取决于CameraShake类的实际情况
- {CameraShakeEvent}应该可以由相对灵活的情况触发
- 即使同样是击中敌人、被敌人击中，显然不同的武器造成的抖动应该不同，但目前我还没有好的思路
- ~~在子弹/攻击动作击中敌人时，触发镜头抖动~~
- 用于模拟后坐力
- 参考该视频：https://www.youtube.com/watch?v=-hTTvybcp7o
- 比如下面这个图，玩家用蓄力攻击会触发镜头抖动

![...](../跃入迷城%20-%20子版本规划/images/v0.0.3.002.png)

- ~~在击杀敌人时触发镜头抖动~~
- ~~在被敌人击中时触发镜头抖动~~

**动画：[动画列表**](https://dikpa4hrtn9.feishu.cn/wiki/Fb9lw0Gcvi4Jy5kKqeOcdUgmnCh?from=from_copylink)**

```- 由于**大量**动画模组都缺失蹲伏动画，而我们**完全**没有体现蹲伏的**游玩战术价值**，目前先**屏蔽蹲伏动作输入**```
- 由于无法将翻滚动画和翻滚效果**合理衔接**，现在将**翻滚**切换为**冲刺**

**近战攻击动画**

- 可以从RootMotion和InPlace之间选择，斟酌后：选择**RootMotion**
1. 从纯玩家习惯来说，俯视角Roguelike肯定还是RootMotion的占主流
2. 从系统拓展性来说，我们以后万一想做什么比较特别的攻击动作，RootMotion的潜力也比较大（不管是其实InPlace的动作，还是比如攻击某一段会后跳的动作）
3. 玩家手感上来说两者差不多其实，如果**RootMotion转身问题**解决了，可能会更好更动感
4. RootMotion当然要调动画来调手感，但考虑到我们一个武器类型就固定的几个动画，应该可以接受，尤其是现在的动画我其实挺满意的
5. RootMotion的**AI角色表现力Much Butter**

**替换到Lyra后的新问题**

- ~~翻滚站立动画衔接不流畅，老问题了~~
- ~~近战攻击似乎有上下身混合，但脚会诡异的平移~~
- ~~所有的武器“拿起”的动作需要一个蒙太奇动画，并且不会根据武器的“安装位置”变化~~
- ~~需要一套子系统，在“拿起”动画播放到特定节点前禁用攻击，并且在节点时将武器MESH转移到手里~~
- ~~通过新的攻击武器调用逻辑移除了该需求~~
- ~~缺少手持近战武器的动画（包括跑步等一系列）~~
- 远程武器的动画手势完全不依赖IK（除了副手）
- 如果未来需要调整主手相对于武器的位置，可能会在动画里增加Vector
- 如果要调整武器在手里的位置，需要调整动画
- ~~翻滚碰撞导致超高速位移 -> 查阅动作系统~~
- 硬直系统用蒙太奇触发

**操作**

**蹲伏：[键盘{C}] / [Xbox手柄{左摇杆按下}]**

```<p>- 由于**大量**动画模组都缺失蹲伏动画，而我们**完全**没有体现蹲伏的**游玩战术价值**，目前先**屏蔽蹲伏动作输入**</p><p>
同步自文档: <https://dikpa4hrtn9.feishu.cn/docx/NegZdhG0toih86xQru5c0DXLnxb#ACJldzUgTsYHhwbkU4pcPahvnPb></p>```
**冲刺：[键盘{空格}] / [Xbox手柄{A}]**

- ~~尝试在翻滚期间取消镜头锁定@Decay⏰2024-11-11 08:00~~
- ~~翻滚应该是一个非常让人愉悦的操作，但目前跃入迷城的翻滚手感很明显差点意思~~
- ~~当然，粗糙的翻滚动画衔接是一个问题，但我感觉这个镜头锁定似乎也起到了副作用~~
- ~~如果要实现这个取消镜头锁定，要务必确保：~~
- ~~翻滚期间角色模型不会转身（不然就太诡异了）~~
- ~~玩家起身时角色朝向指针方向~~
- ~~参考其他俯视角游戏的翻滚（以及冲刺）@龚政涛⏰2024-10-22 08:00~~
- 手柄A键被强制绑定到鼠标左键（在IA之外）
- ~~翻滚方向以键盘优先，其次是鼠标指针方向，再次是角色面朝方向@Decay~~
- 现在如果不输入键盘指令，角色朝向会优先于鼠标指针方向

**[2024-11-12 11-37-22.mp4]**

**瞄准：[鼠标{XY}轴] / [手柄{右摇杆XY}轴]**

- 手柄右摇杆输入无效

**攻击：[鼠标{左}] / [Xbox手柄{RB}] / [PS手柄{R1}]**

- 远程
- 输入
- ~~尝试移除“半自动”这个类别，用更大的后摇体现半自动武器~~
- ~~半自动到目前为止没有给我带来任何必要的体验：玩家按慢点就是了/~~

```<p>- ~~武器无需切换，按下对应按键自动触发攻击@Decay~~</p><p>- **远程武器**：鼠标左键</p><p>- **近战武器：**鼠标右键</p><p>- **投掷武器：**键盘E</p><p>- **赛博格技能：**键盘Q</p><p>
同步自文档: <https://dikpa4hrtn9.feishu.cn/docx/NegZdhG0toih86xQru5c0DXLnxb#FtlTdc0c6sOaq8bJ7dZcSQsUnKf></p>```
- ~~副手武器（近战）攻击完以后，会维持在近战武器在手的状态，这个时候玩家如果按下[R]应该要能切回主手武器换子弹@Decay⏰2024-11-28 08:00~~
- ~~反馈~~
- ~~VFX~~
- ~~枪口火焰~~
- ~~子弹尾轨：希望完整的从枪口延伸出去，现在经常会消失，离枪口也很远~~
- ~~击中效果~~

**换弹：[键盘{R}] / [Xbox手柄{Y}]**

- ~~换弹期间翻滚时，换弹的进度应该继续保留@Decay⏰2024-12-12 08:00~~
- 例如，我在0秒开始进行一个耗时2秒的换弹，然后同一瞬间进行耗时1秒的翻滚，翻滚结束后我的换弹动作应该还剩1秒，而不是被打断重置
- 换弹期间进行翻滚，翻滚结束后动画应该卡上换弹对应帧数
- 例如上一个例子，翻滚后换弹动画应该从1秒而非0秒开始播放

**交互：[键盘{F}] / [Xbox手柄{X}]**

**装备**

**武器**

**面板伤害**

- **武器数值公式**
- DPS = 矫正后伤害 x 每动弹丸数量 / 攻击间隔
- 矫正后伤害 = 武器系数 x 矫正前伤害
- 矫正前伤害 = 基础伤害 + 补正伤害
- 补正伤害 = 基础伤害 x 矫正系数 x SUM(属性 x 属性补正）
- **武器数值公式总结**
- DPS = 武器系数 x (基础伤害 + (基础伤害 x 矫正系数 x SUM(属性 x 属性补正))) x 每动弹丸数量 / 攻击间隔
- **名次解释**
- 矫正前伤害、矫正后伤害，是随计算生成的被动数值，其中矫正后伤害被展示在武器UI面板
- 武器系数是策划定义的、用于补偿不同攻速、类型武器间，期望伤害一致的情况下，面板伤害的差异
- 针对多发、多动武器，策划可以用“核算武器系数 / 每动弹丸数量”辅助计算，但不记录到游戏代码中
- 每动弹丸数量、攻击间隔、基础伤害、武器系数、矫正系数，是由策划预先配置的**武器性能**参数，一般不随武器等级成长而成长
- 属性补正，是由策划预先配置的**武器成长参数**，随武器等级成长而成长
- 属性，是角色参数，随角色成长而成长
- 核算武器系数：用于处理不同武器同样强度下的面板数值差异，例如冲锋枪和太刀，即使强度相同，前者面板伤害也显然应该低非常多（攻速更快）
- **针对多发武器伤害的计算**
- 每动多发武器，每发子弹造成ID内定义的伤害和削韧
- 系统中使用的武器系数已经考量了武器默认的每动弹丸数量，在表中由策划保障合理性
- 当武器得到追加发射的类效果时，每发弹丸的伤害不变，整体伤害等比增加；削韧同理
- 同理到所有单发单弹丸武器，如果由于效果变成了双弹丸，伤害应该翻倍
- 同理到分裂弹的情况，如果武器击中目标后应该“分裂成3发弹丸”，当玩家获得了“分裂弹丸数量+1”的效果时，每发子弹伤害不应该减少

**异常积累**

- 武器有一个单独的“异常伤害”属性，每次对敌人造成伤害时，一并造成属性伤害
- 当角色的属性伤害积蓄满时，会受到对应的属性异常状态
- 属性伤害积蓄满后，会清零
- 每种属性伤害单独计算积蓄值
- 角色处于对应的属性异常状态期间时，依旧可以积蓄对应属性异常

**主动技能**

- 武器均带有1个主动技能，当武器在手时，按下武器技能键释放对应武器的主动技能
- 主动技能有不同的释放模式 @Cade@Decay

```<p>- 非瞬发、切换技能均可以被硬直打断蓄力、瞄准、引导过程</p><p>- ~~技能释放方式：瞬发@Decay~~</p><p>- 按下后直接释放技能，并开始计算CD；</p><p>- 原则上仅用于无需瞄准的技能；</p><p>- 动画一次性播放</p><p>- 技能释放方式：切换@Decay</p><p>- 按下后直接释放技能；</p><p>- 再次按下后取消释放，并开始计算CD；</p><p>- 原则上仅用于为无需瞄准的目标施加状态的技能；</p><p>- 动画一次性播放</p><p>- ~~技能释放方式：瞄准@Decay~~</p><p>- 按下后瞄准（出现对应的瞄准提示，可能是激光、引导线、引导圈等，非必须）；</p><p>- 再次按下取消瞄准</p><p>- 按下对应的武器攻击键后释放技能，并开始计算CD；</p><p>- 可能对玩家移动存在限制（减速、限制旋转、限制移动等，非必须）；</p><p>- 按住后持续的时长对技能最终的效果可能产生影响（非必须）；</p><p>- 瞄准动作播放动画前摇（循环部分），释放动作播放动画中间和后摇</p><p>- 循环部分：例如居合斩的前摇应该是一个收刀动作，循环部分应该是手握刀柄的准备动作；补充：其中间部分应该是斩击动作，而后摇应该是完成斩击到正常站立动作；其他动画以此类推</p><p>- ~~技能释放方式：蓄力@Decay~~</p><p>- 按住瞄准（出现对应的瞄准提示，可能是激光、引导线、引导圈等，非必须）；</p><p>- 放开输入、达到时间上限后（非必须，可能是必要条件）释放技能，并开始计算CD；</p><p>- 如果存在最小蓄力时间，则在蓄力时间到达前放开输入会取消蓄力；</p><p>- 在武器指针位置制作UI展示对应蓄力进度</p><p>- 原则上应该对玩家移动存在限制（减速、限制旋转、限制移动等，非必须）；</p><p>- 按住后持续的时长对技能最终的效果可能产生影响（非必须）；</p><p>- 瞄准动作播放动画前摇（循环部分），释放动作播放动画中间和后摇</p><p>- 循环部分：例如居合斩的前摇应该是一个收刀动作，循环部分应该是手握刀柄的准备动作；补充：其中间部分应该是斩击动作，而后摇应该是完成斩击到正常站立动作；其他动画以此类推</p><p>![...](../跃入迷城%20-%20子版本规划/images/v0.0.3.003.jpeg)</p><p>- ~~技能释放方式：引导@Decay~~</p><p>- 按住后瞄准并释放技能（出现对应的瞄准提示，可能是激光、引导线、引导圈等，非必须）；</p><p>- 放开后、达到时间上限后（非必须）取消释放，并开始计算CD；</p><p>- 可能对玩家移动存在限制（减速、限制旋转、限制移动等，非必须）；</p><p>- 按下后播放前摇和中间动画，持续期间循环播放中间动画，放开后播放后摇</p><p>- ~~持续：~~</p><p>- ~~按下后直接释放，并保持在释放状态，期间可以持续瞄准（出现对应的瞄准提示，非必须）；~~</p><p>- ~~再次按下、释放结束后结束释放技能（并非所有技能都适用这3类结束形式）；~~</p><p>- ~~可能对玩家移动存在限制（减速、限制旋转、限制移动等）；~~</p><p>- ~~瞄准动作播放动画前摇，释放动作播放动画中间和后摇；~~</p>```
**展示**

- **武器面板的UI**

![...](../跃入迷城%20-%20子版本规划/images/v0.0.3.004.jpeg)

- ~~远程武器的子弹散布回落应该只在一个完整的攻击循环结束后生效（而不是always一边涨一边跌）@Decay⏰2024-12-30 08:00~~

**义体**

- 义体提供以下5种属性
- 生命值（上限 & 当前）
- 护甲值（临时值）
- 力量（比例增加生命值）
- 角色基础生命 (包含固定追加值) = A
- 角色力量 = B（基准初始值为10）
- 角色实际生命 = C
- **C = A + A x [SQRT(B - 10) x 0.1]**
- 在该比例下
- 10力量的单位：C = A
- 80力量的毕业全力单位：C == 1.8A
- 反应（比例增加攻速）
- 武器基础攻击间隔 = A
- 角色敏捷 = B（基准初始值为10）
- 武器实际攻击间隔 = C
- **C = 1 / {[(1 + SQRT(B - 10) \* 0.1) / A]}**
- 在该比例下
- 10敏捷的单位：C = A
- 80敏捷的毕业全敏单位：C == 0.5A
- 智力（比例增加属性异常积累效率）
- 武器基础异常伤害 = A
- 角色智力 = B（基准初始值为10）
- 武器实际异常伤害 = C
- **C = A + A x [SQRT(B - 10) x 0.35]**
- 在该比例下
- 10智力的单位：C = A
- 80智力的毕业全智单位：C == 4A

**智脑**

- 智脑是一种特殊义体，由智脑中枢（一个专门的打印机）提供
- 定位类似于哈迪斯的锤子
- 智脑没有等级（无法升级），提供额外1个主动技能，并且有固定的数值
- 关于智脑的剧情定义，详见

**成长性奖励**

- 武器打印
- 购买武器
- 每次刷新1个
- 武器升级
- 升级武器
- 任选升级1个
- 义体打印
- 购买义体
- 每次购买1个
- 义体升级
- 升级武器
- 3选1升级

**非成长性奖励**

- 成长性奖励
- 非成长性奖励

**最终结构**

![...](../跃入迷城%20-%20子版本规划/images/v0.0.3.005.jpeg)

**模板Build**

[物品列表](../跃入迷城 - 数据库/物品列表.md)

**TASK**

- ~~制作“株连”系列技能进行测试@Decay⏰2024-12-30 08:00~~
- ~~制作武器技能：麻痹射击@Decay⏰2024-12-21 08:00~~
- ~~制作武器技能：电磁护盾@Decay⏰2024-12-21 08:00~~
- 根据新的数值系统，调整调整武器伤害逻辑
- 详见上文武器部分：[v0.0.3](https://dikpa4hrtn9.feishu.cn/wiki/AtRFwyLvmiSmSAkA1P7cA0u2nXc#share-FfG2dyXrsoorxWxrX2cccfuznmf)

**装备/奖励设计**

- 1 = 表现最差；3 = 表现中等；5 = 表现最好
- 补正取向：武器基于多少属性补正伤害
- 伤害：同时考虑了高速和低速武器（面板和攻速）
- 冲击力：不跟随品牌走，属于高层配置，跟随武器类型 + 特殊设计走

**武器**

**品牌**

- **纪念碑**：**经典**的生产商；提供**平衡**的伤害和手感，以及可靠的**稳定性**
- 伤害 = 3
- 弹容量 = 3（远程）
- 子弹散布 = 3（远程）
- 体力消耗 = 3
- 补正取向 = 1~2
- **野望**：**狂放不羁**的生产商；提供**不可靠**的手感和**高额**伤害和，以及富有**挑战性**的使用者需求
- 伤害 = 5
- 弹容量 = 2（远程）
- 子弹散布 = 2（远程）
- 体力消耗 = 2
- 补正取向 = 2~5
- **劳旅**：**实用主义**的生产商；提供惊人的**持久性**和以弥补**伤害**的不足
- 伤害 = 2
- 弹容量 = 5（远程）
- 子弹散布 = 2（远程）
- 体力消耗 = 3
- 补正取向 = 1~2

**义体**

**构成**

- 部位
- 技能

**品牌**

- **纪念碑**：**经典**的生产商；提供围绕**子弹/恢复**的进攻能力
- **野望**：**狂放不羁**的生产商；提供围绕**暴击**的进攻能力
- 伤害 = 5
- 弹容量 = 2（远程）
- 子弹散布 = 2（远程）
- 体力消耗 = 2
- 补正取向 = 2~5
- **劳旅**：**实用主义**的生产商；提供围绕**子弹/体力自动恢复**的能力
- 伤害 = 2
- 弹容量 = 5（远程）
- 子弹散布 = 2（远程）
- 体力消耗 = 3
- 补正取向 = 1~2
- XX：提供围绕**电磁**伤害的进攻能力

**哪些放到义体、哪些放到芯片：**

- 特殊的、**有趣的**、不希望玩家拿重复的放到义体
- 相对标准化的放到芯片（芯片是一个有超过1格的义体部位）
- **义体围绕效果而非部位设计，以后再找补设定**
- **远程技能：限制{1} -> 对应哈迪斯特技**
- **近战技能：限制{1} -> 对应哈迪斯普攻**
- 武器击中目标后，会额外生成3发子弹，造成33%伤害，射向附近目标。
- 弹夹内最后一发子弹造成额外200%的伤害。
- 攻击会击退敌人0.5m，并造成额外50%伤害，如果敌人在击退过程中被拦截，对其和被拦截对象额外造成50%伤害。
- 对没有受到负面效果的敌人，造成额外100%的伤害。
- 对受到负面效果的敌人，造成额外50%的伤害。
- **投掷技能：限制{1} -> 对应哈迪斯法阵**
- **武器切换：限制{X}**
- 在弹夹内子弹用完的情况下切换武器，会装填上一把武器的弹夹，每**20s**触发一次。
- 切换武器后**5s**内造成的伤害提高**50%**，每**20s**触发一次。
- **移动能力：限制{X} -> 对应哈迪斯赫尔墨斯的祝福**
- 身形敏捷：**翻滚**时可以**穿过**其他角色。
- 热身：**翻滚**或**冲刺**后**5s**内，造成的**伤害提高50%**。
- 不动如山：原地不动时，**力量提高200%**。
- **冲刺**时，有**50%**概率闪避**子弹**。
- **冲刺**的最初**2s**不消耗**体力**。
- **视野：**
- **生命护甲：**

**Build案例：**

- 武器：
1. 纪念碑 · DS左轮

- 义体：
- 手臂：攻击时有50%概率**额外发射2发子弹**。
- 腿部：原地不动时，**力量提高200%**。
- 眼球：视野范围**缩小50%**，造成的**伤害增加200%**。
- 皮肤：受到伤害时，恢复10点体力。

**新的义体技能举例**

技能的分类可能会调整，但应该足够举例

- **主手 · 快枪手**：每隔{一段时间}，你的主手**手动**攻击前{3}次变得非常迅速*（没有前后摇）*。
- **主手 · 流弹：**你的主手攻击击中敌人后，还会对其身边的敌人发射{3}发子弹，每发造成{50%}武器伤害。
- **主手 · 制导：**你的主手攻击会（一定程度）追踪敌人，但每次消耗{2}发子弹。
- **主手 · 内爆弹：**你的主手攻击会（一定程度）追踪敌人，但每次消耗{2}发子弹。
- **副手 · 冲刺斩击：**长按副手攻击以**蓄力**，释放后向前冲刺{4m}，并对途径的敌人造成{200%}武器伤害。
- **副手 · 重击：**你的副手攻击，释放后向前冲刺{4m}，并对途径的敌人造成{200%}武器伤害。
- **投掷 · 震慑：**受到你投掷武器影响的敌人，还会在{3}秒内减速{50%}。
- **投掷 · 腐蚀：**你的投掷武器在投掷轨迹上留下腐蚀气体，每秒造成{10%}武器伤害，持续{5}秒。
- **技能 · 内循环：**你释放赛博格技能后的{3}秒内，造成的伤害提高{50%}。
- **其他 · 适应性**：你的反应增加{200%}。
- **其他 · 嗜血：**你受到伤害后的{5}秒内，力量提升{10%}，可以叠加（单独结算层数和持续时间）。
- **其他 · 灵巧：**你受到伤害后的{5}秒内，力量提升{10%}，可以叠加（单独结算层数和持续时间）。
- **其他 · 扎根：**原地不动时，你的力量提升{200%}。
- **其他 · 门清：**对没有受到Debuff的敌人造成的伤害提高{100%}。
- **其他 · 混账：**对受到Debuff的敌人造成的伤害提高，每受到{1}类Debuff，提高{20%}。

**讨论记录**

**12/15 - 武器属性问题 @Cade@Decay**

- **问题**
- 目前义体和武器都会对敌人附加Debuff，导致Debuff的归属有些混乱
- 并且武器的Debuff（如先前讨论）需要积累异常值，但义体不用，存在明显的平衡性问题
- **方案-1**
- 从义体中移除“施加Debuff”类的技能
- **优点**
- 解决了上述问题
- **缺点**
- 增加了义体技能的设计难度/丰富程度
- 减少了可用的Debuff数量（我们不可能把所有Debuff放到武器，武器会太琐碎）
- **方案-2**
- 从武器中移除属性，只保留异常积累值
- 通过义体施加具体的异常属性
- **优点**
- 很新颖
- 解决了上述问题
- 强化了武器和义体结合的深度
- 义体的组合变得自由（攻击施加灼烧、冲刺施加重伤这样的组合变得可能且有意义）
- **缺点**
- 弱化了武器和武器间的差异性
- 无法根据伤害属性设计武器属性补正
- **方案-3 @Taobe以方案3为基准向下推进**
- 指定特定的属性到武器，特定的到义体
- 武器使用异常附加Debuff，义体依旧直接附加
- **优点**
- 平衡了方案1、2的优缺点
- **缺点**
- 二者包含的Debuff需要有非常合理的分割界限
- **方案-4**
- 指定特定的属性到武器，特定的到义体
- 在方案3的基础上：所有义体的Debuff也基于当前武器积蓄异常值后出发点
- **优点**
- 平衡了方案1、2的优缺点
- 在此基础之上解决了义体Debuff没有积蓄异常的问题，保留了方案2的武器深度，同时让义体技能的设计更自由（不用担心会太Imba）
- 武器和义体的技能不用隔离，武器和义体可以附加同样的debuff
- **缺点**
- 也许系统会更复杂？
- 义体的技能提升变得不那么直接（因为也要攒异常积累）

**12/6 - 武器数值结构**

@Cade我尝试还原了你原来的公式，武器伤害如下：

- DPS = 矫正后伤害 x 每动弹丸数量 / 攻击间隔
- 矫正后伤害 = 武器系数 x 矫正前伤害
- 矫正前伤害 = 基础伤害 + 补正伤害
- 武器系数 = 核算武器系数 / 每动弹丸数量
- 补正伤害 = 基础伤害 x 矫正系数 x SUM(属性 x 属性补正）

**总结公式：**

- DPS = 武器系数 x (基础伤害 + (基础伤害 x 矫正系数 x SUM(属性 x 属性补正))) x 每动弹丸数量 / 攻击间隔
- 针对多发武器（霰弹、多连发）的特殊处理@Decay
- 每发子弹伤害 = 矫正后伤害 / 每动弹丸数量
- 武器面板则显示为“每动弹丸数量 x (矫正后伤害 / 每动弹丸数量)”
- 该数值应该**相对固定**，也即，当玩家获得了“增加弹丸数量”的效果时，每发子弹伤害不应该减少
- 同理到所有单发单弹丸武器，如果由于效果变成了双弹丸，伤害应该翻倍
- 同理到分裂弹的情况，如果武器击中目标后应该“分裂成3发弹丸”，当玩家获得了“分裂弹丸数量+1”的效果时，每发子弹伤害不应该减少

**其中：**

- 矫正前伤害、矫正后伤害，是随计算生成的被动数值，其中矫正后伤害被展示在武器UI面板
- 每动弹丸数量、攻击间隔、基础伤害、武器系数、矫正系数，是由策划预先配置的**武器性能**参数，一般不随武器等级成长而成长
- 属性补正，是由策划预先配置的**武器成长参数**，随武器等级成长而成长
- 属性，是角色参数，随角色成长而成长
- 武器系数：用于处理不同武器同样强度下的面板数值差异，例如冲锋枪和太刀，即使强度相同，前者面板伤害也显然应该低非常多（攻速更快）

**问题：**

- 补正伤害：按照上述公式，武器的补正伤害会随着武器等级上升，在属性补正不上升的情况下上升，玩家会看到自己属性没变、武器补正没变的情况下，补正伤害变高了，这是我们预期的效果吗？
- ~~矫正系数：用于让相同的属性补正数值有不同的伤害数值，这个有必要吗？为什么不能直接调整属性补正（因为矫正系数玩家是看不到的）显得更直观？~~

武器系数、矫正系数，是由策划调整的武器基础属性，不随武器成长而成长

**11/29**

**角色**

- 追加能量条，用于释放技能，不会自动回复@Decay

**武器**

- ~~只限制左键、右键的输入各固定一把武器，不限制武器类型@Decay⏰2024-12-11 08:00~~
- ~~调整武器打印机，每次奖励只给1个武器@Decay⏰2024-12-31 08:00~~
- 但每层提供多个奖励房间，驱动玩家探图
- ~~属性补正和武器技能，与武器类型进行强关联@龚政涛@苏祺恒~~
- 技能确保独特，降低玩家**选择成本**
- 策划考量，程序不限制
- 以太刀为例：
- 可以补正属性：{敏捷、力量、耐力}
- 可以出现技能：{居合斩、弹返、燕返}
- ~~技能与键位：{Q/E}对应主武器、{G}对应其他功能（主动技能，由智脑提供）@Decay⏰2024-12-30 08:00~~
- ~~武器可以切换（滚轮）@Decay⏰2024-12-12 08:00~~
- 哪把武器在手里哪把就是主武器，而不是和按键挂钩，但依旧保留按键单独用于切换
- 这样可以避免明明在用副武器，一大堆技能都跟主武器挂钩的情况，更直观
- 同时，这样左右键纯粹是操作习惯区别，避免逼玩家主武器绑定左键
- **武器属性**与武器一对一唯一绑定，属性**不再**造成不同的生命/护甲伤害补正，而是造成特殊效果
- 参考效果如下，细节待定
- 2个强化方案：
- ~~要么属性全是固定数值，用义体或者其他技能强化效果~~
- ~~要么属性全是百分比数值，包括非伤害debuff，和武器面板/角色属性挂钩~~
- 变种：类似怪猎，属性需要积攒，攒满了触发属性异常
- **动能：**对护甲造成额外{30%}伤害
- **电磁：**对敌人施加“**麻痹**”Debuff，移动速度降低{50%}，持续{3}s；不可叠加，重置CD
- **热能：**对敌人施加“**灼烧**”Debuff，每秒造成{5%}武器伤害，持续{5}s；可以叠加，单独计算CD
- **纳米：**造成的伤害减少{50%}，对敌人施加“**纳米侵蚀**”Debuff，每秒造成{5%}武器伤害，持续{10}s;可以叠加，重置CD;敌人死亡后，全部层数会转移到{12}m范围内的最近敌人
- **辐射：**造成的伤害穿透敌人，对背后的敌人造成越来越少的伤害，每个敌人减少{20%}
- **霜冻：**对敌人施加“**冻结**”Debuff，持续{5}s，可以叠加，重置CD；叠加到{10}层时，冻结*大部分*敌人，使其无法行动，持续{5}s，期间不会受到额外的“**冻结**“Debuff
- **冲压：**造成伤害后{1}s，在击中的位置/目标再次造成一次范围伤害，等于原始伤害的{15%}
- 武器属性与武器类型、武器属性补正三者互相关联（策划考量，程序不限制）@龚政涛@苏祺恒
- 从而限制随机性、提升玩家选择熟练度以**降低选择成本**、提升**游戏代入感**，例如：
- 太刀：可以补正{敏捷、力量、耐力}
- 电磁：主属性智力
- 热能：主属性耐力
- 电磁太刀 A = 智B、{敏/力/耐}C
- 热能太刀 A = 耐B、{敏}C
- 热能太刀 B = 耐A
- 武器升级时，增加基础伤害；在Lv4 -> Lv5时，增加补正，Lv5最高且不再追加@苏祺恒@龚政涛
- 部份武器升级到Lv5时，解锁特殊技能
- 武器升级带来的技能升级，以及特殊技能，都由策划配表实现

**义体**

- 义体不**强制**做套装，和被动技能一对一唯一对应
- 属性补正保留在义体，用于平衡选择取向，也即和被动技能存在设计相关性
- 以防某个技能在所有流派都被选择，尽可能引导玩家做出“指南针”形的build
- 属性减少，保留力量、反应、智力@龚政涛@苏祺恒
- 属性提供二级加成（例如攻速、移速、伤害减免等）二级加成不再单独提供在义体
- 确认属性提供的二级加成@龚政涛@苏祺恒
- 义体技能可能提供二级属性加成相关的技能，此类技能则不由属性补正

**通用**

- ~~简化打印机UI并更新@龚政涛@Decay⏰2024-12-30 08:00~~

**问题 @Cade@Decay**

**复杂度问题**

现有问题：主要是需要你帮忙协助确认一些Build方案细节，然后我们再往下细化

- ~~在武器可以自由配置的前提下，使用武器技能是基于哪把武器的？~~
1. 我目前的想法是2个方案：选择方案1
1. 方案1：Q键固定释放武器技能，玩家手里是哪把武器，就是哪把武器的技能；E释放“智脑”技能；鼠标滚轮/对应的攻击动作切换武器；
2. ~~方案2：Q/E固定释放槽1/槽2的武器技能；G释放“智脑”技能~~
2. 我觉得相对来说方案2少一个实时操作，玩起来更流畅一点？
3. 基于以上方案，义体技能对武器技能提供的强化必须能适配所有武器（无论方案1还是方案2）
- ~~我还是在思考二级属性和被动的关系，希望先列出有多少二级属性是需要出现在我们游戏里的？~~
1. 二级属性做到被动里，主要还是为了降低玩家的Build考虑成本，这样玩家选义体时，每个义体基本只需要看被动，属性就纯粹是添头；如果暴击这样的属性会出现在属性里，玩家要“更认真”看的东西就多一个了，带来的优势是什么？因为我感觉二级属性做到被动里数值调整的好的话Build的流派也会更多样化。
2. 暴击
3. 吸血
4. 攻速追加：这个我希望不要出现，魂like里攻速太影响平衡性
5. 霸体/追加韧性等级
6. 移速追加
7. ？

以下几个设计（我知道有一些我们已经讨论过）是增加了游戏复杂度的，我还想要聊一下他们的必要性

- 自由的武器组合（而非主副手固定近战+远程）
- 义体附带的属性（而非把属性——我这里说的是全部而非仅仅二级属性——加成作为一种被动技能）

**方案组合**

![...](../跃入迷城%20-%20子版本规划/images/v0.0.3.006.jpeg)

**点击图片可查看完整电子表格**

**武器**

- 建议武器的伤害构成不暴露给玩家，仅体现结果
- 这样玩家不需要思考具体“为什么我升级这次加了基础伤害，那次加了补正伤害”，只需要学习“什么动作导致面板伤害上升”即可
- 具体展示见上文思维导图
- 武器说明从武器面板移除，保留到安全屋的收藏品面板
- 游戏中要出现和武器伤害无关的固定伤害技能吗？
- 要么要，要么不要，不要出现两种情况都有的case，降低玩家的思考成本
- 武器技能造成的伤害如果是和武器伤害挂钩的，需要在面板展示什么数值？
- 方案1：结果数值；例如“造成320伤害”
- 优点：可以直接看到效果
- 缺点：和武器面板的关联关系玩家可能需要思考后才知道
- 方案2：转化比例；例如“造成200%武器伤害”
- 优点：可以明显看到技能本身的“价值”
- 缺点；实际伤害数值需要换算一下

**义体**

- 二级属性是否是被动技能
- 例如“暴击率”、“吸血”之类的词缀，是作为被动技能还是属性出现？
- 被动技能的案例：哈迪斯
- 属性的案例：土豆兄弟
- 对于“智脑”（提供主动技能的道具），我建议不要和义体打印机混一个池子？单独刷新比较好？
- 我们需要像哈迪斯一样，限制每个相关性技能只有1个可用部位出现么？
- 例如腿部只允许一个，不同品牌效果不同
- 我觉得这也会降低玩家的选择成本
- 游戏中要出现和武器伤害无关的固定伤害技能吗？
- Same as 武器，要么要，要么不要，不要出现两种情况都有的case，降低玩家的思考成本
- 理想情况下，和武器保持一致，但这里我觉得不同也能接受
- 要：
- 优势：所有对武器的升级都能反应到技能数值，build思路更宽广
- 缺点：选择义体时玩家要考虑武器数值问题，并且我们还要处理主副武器用哪个数值的问题（当然，我建议是一律用主武器）
- 不要：
- 优势：玩家思考更简单
- 缺点：武器等于白升级
- 对于武器和义体的这两个设计问题，我整体都倾向于要@Decay@Cade
- 其他义体设计问题暂未讨论

**Build问题**

- 多武器系统显得多余、无趣、不合理
- 武器的切换除非必要否则根本不会进行
- 近战和远程应该更合理的搭配，但现在的系统做不到
- Slot的概念太过混乱
- Build系统信息过多，游玩过程中（尤其是选择升级对象时）失去焦点和思路
- 面板有**太多太多太多**需要关注的**内容**了，玩的时候根本不会注意看
- 差异和升级都太细微，玩家打了像没打一样

**更改思路**

![...](../跃入迷城%20-%20子版本规划/images/v0.0.3.007.jpeg)

**武器系统**

- ~~玩家只能携带**1把近战武器**、**1把远程武器**、**1个赛博格技能; YES**~~

```<p>- ~~武器无需切换，按下对应按键自动触发攻击@Decay~~</p><p>- **远程武器**：鼠标左键</p><p>- **近战武器：**鼠标右键</p><p>- **投掷武器：**键盘E</p><p>- **赛博格技能：**键盘Q</p>```
- ~~调整武器的效果，移除对护甲和生命的伤害补正（可以保留系统，数值调整成一样的）YES~~
- 原来的这套补正太“隐晦”以及不明确了
- ~~武器**移除技能 NO**~~
- ~~武器移除基础伤害的展示：**面板只显示总伤害**~~
- 4 -> 5升补正，其他都不升；只升级基础伤害
- ~~Build系统参考**哈迪斯 NO**~~
- ~~武器技能通过义体单独附加，只有被动，让玩家的注意力聚焦在4个武器的操作上~~
- ~~待定：移除子弹分类，只用于计数？ YES~~
- 有一说一，在场景里挑子弹的体验并不好
- ~~待定：属性武器附带特效 **or** 技能{改变/附加}武器属性，同时改变消耗的弹药类型？YES~~
- ~~属性与武器绑定，但不强相关（比如太刀可以有动能和热能）YES~~
- 限制随机性，类似补正和武器类型的关系
- 举例：
- 太刀：敏捷、力量、耐力
- 电磁太刀 = 智B、{敏/力/耐}C

**义体系统**

- ~~每个义体对应**1个被动**技能 YES~~
- 义体提供什么？
- 属性 + 被动
- 关键问题：
- 二级属性是否是被动技能
- ~~技能加成到全额面板伤害，强化提升体验~~
- 举例：
- + 20% 伤害
- 电磁：造成额外15%电磁伤害 =140 \* 0.15 = 140 + 140 \* 0.2 + 140 \* 0.15
- 武器伤害 = 基础伤害 + 补正伤害
2. 大部分技能、属性造成的额外伤害：基于武器伤害
3. 基础伤害的追加，例如“增加20%基础伤害”会直接加在白值：100 -> 120；
1. 尽量不出现加基础伤害的技能，但可以作为技能的BUFF出现
2. 基础伤害 = 武器系数 \* 等级系数
1. 100 = 0.4 \* 10
3. 如果有超过1个追加值
4. 补正伤害：原则上不通过技能追加
- 技能：
- 4个攻击动作各有1个**不可重复**（这个我还要研究一下）的部位（主手、副手、投掷武器、主动技能）
- 弱化“部位”的概念，玩家只需要在需要替换时意识到就行，降低选择复杂度，主要用于体现沉浸感
- ~~除此之外的普通技能（行为芯片）**不限制数量**（这个我也要研究一下）~~
- 义体所有的**属性补正移除**，属性补正以技能形式出现
- 如“力量提高200%”
- ~~生命值与属性脱钩，单独补正~~
- 义体技能不对“任何”武器做限制，确保玩家可以任意组合Build
- ~~不出现“手枪伤害提升20%”这种没手枪就废了的技能~~
- ~~这里和前面的“属性武器附带特效”可能会有所冲突，所以可能需要以下方法解决~~
- ~~武器属性本身可以通过技能调整~~
- ~~不出现与属性强相关的技能~~
- 移除**融合打印**
- 这个设计的价值是“减少玩家随机到垃圾奖励”的问题和“增加BUILD的随机组合涌现性”
- 如果“技能可以改变武器属性”并且“所有强化技能不跟随武器特性唯一绑定”那上述两个任务已经完成
- 待定：移除神经负担？

**更改后的奖励系统**

- 除了获得信用点，所有的奖励都花钱，凸显“赛博朋克”世界一切都可以购买、一切都需要购买的主题

**成长性**

- 武器打印机：获得新的武器（3选1）
- 限制方案1：每次只会出现一个品牌，但是部位随机 -> 哈迪斯
- 限制方案2：每次只会出现一个部位，但是品牌随机 -> 武器的话这个可能好一点？但会不会和义体搞混？
- 限制方案3：完全随机 -> 暖雪
- 义体打印机：获得新的义体（3选1）
- 限制方案1：每次只会出现一个品牌，但是部位随机 -> 哈迪斯 -> 义体的话这个可能好一点？
- 限制方案2：每次只会出现一个部位，但是品牌随机
- 限制方案3：完全随机 -> 暖雪
- 武器升级：提升武器的补正（3选1）
- 义体升级：提升技能效果（3选1）
- 能力提升：提升属性（3选1）
- 哈迪斯的石榴效果太含蓄了，我希望移除石榴，体现在这里
- 属性提升类似于“升阶”而不是“追加数值”，有限且需要边际递减效应，以体现多补正武器的后期优势
- 举例来说：普通 = 10，稀有 = 20，精良 = 28，史诗 = 35，传说 = 40
- 追加生命：定额
- 追加护甲：定额

**非成长性**

- 获得信用点：定额
- 恢复生命：定额
- 恢复护甲：定额
- 获得子弹：定额，自选（玩家应该可以选择补给的子弹种类）

**更改后的Build结构**

![...](../跃入迷城%20-%20子版本规划/images/v0.0.3.008.jpeg)

**关卡**

**门**

- ~~需要一个自动门，或者对现有的Slider Door类增加功能，用于处理电梯门Start⏰2024-12-28 08:00~~
- 目前的想法是：起始的电梯门应该会在玩家进入BOX内自动开启（我会把Player Start放在Box里，所以每次切换Level应该都会自动开启）
- 玩家离开后，门自动关闭，并且不再可交互，以此提高关卡的写实度
- 考虑到AI也需要用自动门，也许如下设计移门基类比较合理？@Decay
- ~~增加一个自动开关功能，并增加TAG，通过TAG判断自动开关对于哪类对象生效⏰2024-12-29 08:00~~
- 目前我们应该只有**Player**、**Enemy**两类，以后可能有**特殊敌对**（中立切换的敌对，可能会导致特殊的场景逻辑）、**中立**、**友方**这额外3类
- 自动开关的TAG为空，则为没有自动开关功能
- 增加一个**计数器**功能，控制自动开关的次数，为0则为无限次
- 增加一个BOOL，用于控制**手动开关是否启用**（电梯门Start应该无法手动开关）
- 调整BOX开关门的逻辑：当BOX里有Charactor时，不触发Overlap end，只有**最后一个Charactor**也离开了才**触发Overlap end**，避免一堆人在门口门不停开关的问题
- 我不确定是否要调整，因为不确定当前逻辑，但目标是上述目标

**关卡切换**

- ~~Arena功能1：可以预先在场景中配置多波次敌人@Decay⏰2024-12-23 08:00~~
- 用于未来有地形的Arena测试，类似于Official Level的DT？
- ~~Arena功能2：一波敌人清空后，刷新下一波敌人，在UI显示剩余敌人@Decay⏰2024-12-24 08:00~~
- 另外在右上角加一个手搓到极致的UI显示波次和剩余敌人
- 刷新直接在配置好的位置“biu”出现就行，牛逼的话加个特效
- ~~Arena功能3：可以在DT中配置每一波敌人的基础属性补正值@Decay⏰2024-12-25 08:00~~
- ~~Arena功能4：在每一关结束后锁定（能看出来就行）@Decay⏰2024-12-26 08:00~~
- 用于测试关卡锁定，并刷新奖励机器
- 该时间应该可配置
- ~~Arena功能5：每一关开始时，随机解锁{x}个奖励机器@Decay⏰2024-12-27 08:00~~
- 用于随机玩家能获得的奖励，而非全部奖励
- 方案1：把该功能配置到奖励机器上，使其“概率解锁”
- 方案2：把该功能配置到关卡管理器，使其“概率解锁”部分奖励机器
- ~~在LevelManager增加一个功能，指定某个SubMap只加载到某个具体Level@Decay⏰2025-01-27 08:00~~
- 具体改动如下：

![...](../跃入迷城%20-%20子版本规划/images/v0.0.3.004.jpeg)

- ~~在配置了多个EnemyMap到Level后，一波敌人清空后，自动刷新下一波敌人@Decay~~
- 类似于Arena功能2
- ~~允许为每一波敌人配置出生点~~
- 配置了出生点的敌人波次（MAP）会一个个（而非一起）生成，每一个敌人生成后会前往配置中的位置巡逻（这个应该不需要特殊处理，AI自己现在就会完成）
- 这里未来需要配合一些演出功能：比如电梯自动开门、浮空面包车停到阳台边上敌人跳下来，现在不需要，但要考虑一下未来的适配性
- 可能的话（可以直接迁移的话）在Arena先测试这个功能，作为Arena功能

**AI**

**AI特殊动作**

- ~~需要一个TASK，让AI使用武器技能@李少秋~~
- ~~需要一个TASK，判断移动并执行开门动作@李少秋~~
- 该动作用于索敌或战斗任务
- AI失去玩家Sight Present后，会尝试前往一个目的地索敌
- AI在战斗任务中，也会尝试生成一个目的地，进行战术位移
- 需要一个Decorator，判断该目的地的最近Nav路径是否经过可打开的移门
- **可能的问题：**门的MESH已经忽略Nav绘制，所以不会阻碍Nav，但不知道该设置是否会影响路径判断
- 如果是，则执行一个附带开门动作的MOVE TASK
- 简化的方法是不是让AI进入一个“可开门”状态，然后让门处理开门动作？因为我不知道要怎么实现一个TASK里的MOVE -> 开门 -> MOVE，尤其是开门还要在具体位置（门的BOX内）触发）
- 关于开门任务被抛弃的Work Around：
- 之所以不让门判断AI的存在和状态，并执行开门动作，是因为：
- 如果AI进入战斗状态，并执行战术移动
- AI移动到一个门的交互BOX内，但他的移动目标到此为止，并不打算越过门
- 此时门无法判断，会正常开门，导致游戏显得不自然

![...](../跃入迷城%20-%20子版本规划/images/v0.0.3.009.jpeg)

**AI提示**

- ~~需要一个TASK用于展示攻击提示@李少秋⏰2024-12-10 08:00~~
- 该TASK应该触发3个事件（可能更少，但需要支持）
- AI敌人的身体闪烁
- AI敌人的头顶UI
- 激光瞄准线，类似下图，只在AIM ON PLAYER期间生效（精确瞄准时出现，真的开始开枪后消失）

- 音效
- 该TASK应该可以对以上3个事件的开始（相对于TASK的开始时间）和持续时间，以及TASK本身的持续时间进行配置
- 例如：AI可能在刚进入攻击流程就显示UI、播放音效，但UI只显示0.2秒，UI显示结束后才开始闪烁
- 闪烁效果应该可选，是一个模块化的单独事件
- ` `目前只需要1种，也即从慢速频闪到快速频闪
- 该TASK可能也会被用在“AI发现玩家”的提示（到时候可能只有UI）应该是一个通用模块

![...](../跃入迷城%20-%20子版本规划/images/v0.0.3.010.jpeg)

- ~~需要玩家角色受击打提示@Decay⏰2024-12-17 08:00~~
- 玩家角色受击打闪红；敌人闪白；不由TASK实现，在Character的受击事件用VFX实现
- 击打效果

**[1.mp4]**

- 受击效果

**[2024-11-21 11-37-21.mp4]**

**11/18**

**问题**

- ~~HasCurrentSight在[7]和[93]位置时，为FALSE时不能Abort后续TASK，但在[139]位置就可以@李少秋~~
- ~~[131]的IsInDistance永远触发（这是个FALSE条件，意味着下面的TASK永远不会运行）无论我是否开启SquareDistance@李少秋~~
- ~~所有的OnPerceptionUpdate（[140、[147]以及我没有截图到的[151]）都无法正确Abort后续TASK，我理解AIC现在会慢慢转过去看玩家，但Perception Abort应该会先生效然后触发[131]的Search？@李少秋~~
- ~~FireDuration的MAX和MIN设置是有了，功能似乎有BUG，只会触发1下攻击~~
- ~~通用：敌人的攻击次数应该是2个输入，分别是攻击次数/持续时长随机范围的上限和下限@李少秋@Decay⏰2024-11-03 08:00~~

**迁移BlackboardKey到AIC属性**

- ~~SearchDistance，用于丢失玩家视野后的Search，指目标地点的接受半径（somehow MoveTo的AcceptanceRadius不生效）@李少秋⏰2024-11-22 08:00~~
- ~~TacticalMoveDistance，用于在有视野、非攻击状态下的战术移动，设置移动半径@李少秋⏰2024-11-22 08:00~~

**迁移BTT到C++**

- ~~BTT\_GetOptoLocation，用于非战斗、有视野的“战术移动”选址@李少秋~~
- 这个BTT主要用于处理“敌人会随机寻址移动”的问题，结果上，会让敌人在一个与当前玩家相关的位置位移（如下图）
- 该功能主要输出2个结果：OptoHalfRadius；OptoHalfLocation
- OptoHalfDistance = Max - Opto 或者 Opto - Min，取较大值
- OptoHalfLocation = Vector{Player -> Enemy} x Length{OptoDistance}
- 简单来说，这个Location应该是以玩家为中心的OptoDistance圆，与玩家、敌人连线的直线的交点

![...](../跃入迷城%20-%20子版本规划/images/v0.0.3.011.jpeg)

- ~~BTT\_SetCurrentLocation，用于获取当前AI的站立位置，很方便@李少秋~~
- 现在迁移到GetActorLocation
- ~~BTService\_SetMoveSpeed@李少秋⏰2024-11-29 08:00~~
1. 使用场景是几个攻击循环里的非攻击移动，我希望这些MOVE不是全速的，而是根据目的地距离慢速的，也即MoveSpeed = (Distance / DefaultMoveSpeed) \* DefaultMoveSpeed
2. 比如500移动速度的AI，移动到一个250距离的目的地，应该以250的速度移动而非500，让移动看起来更自然（当然，这里要Clamp一下，从MinMoveSpeed到DefaultMoveSpeed）
3. 这里涉及另一个问题是AI的AttackDesire应该能正确Abort低优先级的行动，以防龟速移动导致不自然的行为，但现在并不行（我在我本地试着设置了low priority但没有用）
4. 追加一个前置的Bool，Relative/Absolute：如果是Relative，用2个Vector作为上述比例的计算，以及两个Float/FloatVariant作为Clamp的范围；如果是Absolute，直接输入一个Float作为移动速度

**11/15**

**问题**

1. IS VISIBLE判断弹道是否通畅并没有按预期工作
1. 似乎队友的阻挡完全不会触发IS VISIBLE为FALSE
2. 来自MESH的阻挡又会导致直接丢失SIGHT进入其他循环
- ~~目前群聚控制下的敌人会把队友尸体考虑进寻路，导致移动卡顿，希望忽略@李少秋⏰2024-11-22 08:00~~

**需求**

1. 需要攻击次数/持续时间的上限、下限的设计
1. 攻击应该在上下限之间随机一个数字触发
- ~~通用：敌人的攻击次数应该是2个输入，分别是攻击次数/持续时长随机范围的上限和下限@李少秋@Decay⏰2024-11-03 08:00~~
- ~~需要2个新的攻击提示TASK@李少秋@Decay~~
- 移除敌人对队友的伤害；并且使子弹能够穿过队友
- 可能的话，把上述两个功能用简单BOOL开关，便于测试
- 希望减小敌人移动碰撞的胶囊体直径，但不改变伤害碰撞胶囊体直径

**11/14**

现在的AI BT已经非常接近我的理想状态，就是有几个小问题

**BUG**

1. 下图中我专门放了一个Draw Debug用于测试，可以看到AI的IS NOT IN DISTANCE逻辑会被高频反复执行好几次，然后才正确执行下去，导致AI搜寻玩家时一开始动作会很不连贯
2. 启用群聚控制以后，AI会被AI的尸体阻挡，导致移动卡死

**问题**

- ~~目前所有的非Sight Sense都是用这一个Decorator判断的，我能在Decorator里设置优先级吗？~~
1. 比如我希望更新的Sensor可以打断更老的Sensor（这个涉及到问题2，已有的Sensor更新坐标，似乎不能Abort执行中的分支）然后不同的Sensor有不同的优先级
1. Sight Sensor > Touch Sensor > Team Sensor > Damage Sensor > Hearing Sensor
2. 我当然也可以把下层逻辑Copy四次，然后上面把Decorator拆开，就是想确认一下有没有更好的做法

![...](../跃入迷城%20-%20子版本规划/images/v0.0.3.012.png)

- ~~AI似乎无法在执行过程中判断Sensor的更新，如下图：~~
1. AI在失去玩家视野、但拥有玩家其他Sensor时，会尝试前往地点搜寻玩家
2. 如果抵达搜寻地点依旧没有Sight，AI会进行一次巡逻逻辑
3. 此时即使Sense更新，也无法打断AI当前的行为，即使我已经设置了Abort Low Priority
1. 我猜想是因为Sense本身的状态并没有切换，因为之前的Sense有记忆，只是Sense的触发坐标更新了

![...](../跃入迷城%20-%20子版本规划/images/v0.0.3.013.png)

**BT问题**

1. ~~IsSetAttackTarget这个Decorator需要Force Success才能过~~
2. ~~SetAttackTarget这个Task不知道怎么Release：AttackTarget一旦Set了能释放吗？~~
3. ~~SetFocus的工作逻辑很奇怪：我尽管Set了，移动的时候似乎也是朝向玩家看的，但并没有100%对准玩家，感觉慢半拍（**见4.的视频**）~~
4. ~~BTT\_LookAt现在转的很不自然（卡顿、诡异的加减速、并且似乎只会顺时针转），而且和角色转身速率脱钩了，我也没找到对应的C++ Task来实现“看着玩家”这件事情~~

**[2024-11-07 11-29-39.mp4]**

5. ~~有时候AI会毫无道理（但很有规律）的自转~~

**[2024-11-07 11-35-59.mp4]**

6. 添头：我经常想要双输入的节点，但似乎BT只有双输出的节点，如下图，很明显我在执行2个一模一样的逻辑，现在我只能copy paste

![...](../跃入迷城%20-%20子版本规划/images/v0.0.3.014.png)

**战斗逻辑**

![...](../跃入迷城%20-%20子版本规划/images/v0.0.3.015.jpeg)

**敌人逻辑**

|<p>![...](../跃入迷城%20-%20子版本规划/images/v0.0.3.016.jpeg)</p><p><br>同步自文档: <https://dikpa4hrtn9.feishu.cn/docx/TdkxdEEtjohnt6xRihVcvTCMnYd#QlYxdpXDOsbDbxbQPCVc30ErnQK></p>|
| :-: |
**目标**

- ~~需要一份比较简单的AI功能文档，说明各个模块的作用以及便于策划修改数值@李少秋⏰2024-11-02 08:00~~
- 现在的模块化拆分感觉很清爽，但没有指导的话没办法一起做

**AI说明文档**

- 问题
- ~~CommonEnemy是后续唯一的BP Parent吗？~~
- yes
- ~~基于CommonEnemy继续开发，哪里设置远程和近战敌人？~~
- 通过手持的武器判断，在BP\_Character里的Weapon配置
- ~~PawnData用来干嘛？~~
- PAWN DATA没有要改的，逐步废弃
- ~~哪个逻辑决定了什么stimulate会被广播，什么不会?~~
- 所有的Report Component负责处理广播逻辑，只要触发就会广播，用BT决定怎么处理广播内容
- ~~Stimulate component是怎么工作的？~~
- 在C++里预先写好的逻辑
- ~~这俩不用，但引用了，所以不能删~~

![...](../跃入迷城%20-%20子版本规划/images/v0.0.3.017.png)

- BT里有is visible的判断、eq也可以
- ~~配置敌人~~
- 直接继承CommonEnemy，改对应的AIC和BT就行
- ~~调整Sensor的范围~~
- 直接在AIC里改
- 调整广播范围
- AI应该忽略门的存在，直接通过门进行导航
- 可以被开启的移门应该在AI Tag的Character进入BOX时自动开启，离开时自动关闭
- 平移需要修复FOCUS相关问题

**美术**

**UI @Zoey**

- 保留常规Hud
- 尝试有斜度的UI（左下、右下）
- Boss可以参考上面中间的UI
- 简洁的风格，生命值、体力、护甲放在左下；武器、技能、弹药、信用点放在右下

![...](../跃入迷城%20-%20子版本规划/images/v0.0.3.018.jpeg)

参考来自《Out of Action》

- 调整脚下的UI条，从内到外分别是：子弹、生命值&护甲、体力
- 生命&护甲用哈迪斯的做法：总长度不变，根据数值比例展示不同的图像比例

![...](../跃入迷城%20-%20子版本规划/images/v0.0.3.019.png)

看这个小怪就是护甲比生命多，所以黄条特别长

- 非战斗状态将脚下的UI淡化到{20%}透明度
- 通过遍历敌人的Behavior Tree是否有Sight Sensor，信息送回到Level Manager，判断是否玩家在战斗状态
- 多人情况下，可能要追加判断Sight Sensor Target判断
- 下图仔细看还能看到一个细节：UI是可以被玩家角色遮挡的（脚后跟）但却又不会被场景遮挡

![...](../跃入迷城%20-%20子版本规划/images/v0.0.3.018.jpeg)

战斗时的UI，注意脚下

![...](../跃入迷城%20-%20子版本规划/images/v0.0.3.018.jpeg)

非战斗状态，主意角色脚下，来自REDACTED

- 再注意这个case右边的小怪：UI是会和地面产生反应的

![...](../跃入迷城%20-%20子版本规划/images/v0.0.3.020.png)

来自游戏《SlavicPunk: Oldtimer》

**Shader**

- 视野外的案例
- 下图阴影里的勾线效果exactly就是我想要的我们战争迷雾灰色区域的效果

![...](../跃入迷城%20-%20子版本规划/images/v0.0.3.018.jpeg)

来自John Wick Hex，居然是个XCOM LIKE，我惊了

- 波点渐出的案例

|![...](../跃入迷城%20-%20子版本规划/images/v0.0.3.021.png)|![...](../跃入迷城%20-%20子版本规划/images/v0.0.3.022.png)|
| :-: | :-: |
- 问题：注意下图Mesh的线条，很显然是程序化破碎的，这个效果我们能实现么？关注的重点在于：我们的Shader似乎只作用于光影，但并没有影响到贴图色彩。
- https://www.bilibili.com/video/BV1AK4y1z7xj?spm\_id\_from=333.788.player.switch&vd\_source=b9b2117b7966b2a6e8d44ba9be99d706

![...](../跃入迷城%20-%20子版本规划/images/v0.0.3.023.png)

**模型**

**目标**

需要把Lowpoly素材的头调整到标准比例，移除面部特征，期望的效果如下

![...](../跃入迷城%20-%20子版本规划/images/v0.0.3.024.png)

**合作伙伴**

- 还是有点confuse关于3D艺术家的工作内容，我suppose有下面几个流传
- 绘制原画：这个步骤似乎只对角色生效？针对场景，我看到太多案例都在用3D辅助渲染处理
- 创建3D角色资产模型
- 创景3D场景资产模型

**外包**

- https://umeshulovers.com/

**VFX**

- 实装新的VFX，测试效果
- 修复子弹VFX问题

**设定**

1. 不同属性的武器会调用不同的VFX
1. 暂时可以先不管，切片只需要先找到合适的**1套VFX**
2. **动能**武器会释放**白色混杂橙色**的VFX
3. **热能**会趋近于火焰的**红色**
4. **电磁**是**蓝色**
2. 远程武器攻击到不同对象会有不同的击中效果
1. 这个切片也需要
2. Projectile本身应该触发一个击中效果
3. 与此同时，受击打对象应该再触发一个击中效果
1. 比如打中有护甲单位显示金属粉尘/能量护盾效果；打中无护甲单位出血；打中墙壁爆烟雾
4. 出于稳定性/视觉考虑，第二个效果可能需要一个CD控制其不会频繁出现

**声音**

**音效**

**整体需求表：[音效需求**](../跃入迷城 - GDD/音乐 & 音效/音效需求.md)**

**电梯**

**电梯启动**

**电梯停止**

**门**

**小型门 door\_single**

**[小型门.mp4]**

**电梯门 door\_lift**

**[电梯门.mp4]**

**巨形门 door\_huge**

**[11月6日.mp4]**

**奖励**

**脚步**

**需求概述**

- 玩家的脚步声应该严格绑定到动画的落地帧
- 玩家的脚步声音量不随移动速度变化而变化，但播放间隔随动画变化而变化，而动画随移动速度变化
- 脚步声应该有至少8个变体，每个变体只包含1下落地声，干脆利落，游戏里随机播放以营造自然的脚步质感
- 8个变体应该两两能任意衔接不会突兀
- 脚步声类似于落在实心、表面磨砂但精致的合成材料，比如超高密度的厚实（20cm以上）塑料
- 我不希望错误传达粗糙的“野外石制表面”的质感，或者有太多“金属回声”

**参考**

- 关于不同地面的脚步声 —— 不实现，至少不在切片实现
- 关于随机audio cue触发实现更自然的脚步声

**[该类型的内容暂不支持下载]**

- 关于动画绑定audio cue（可能不适用于wwise）

**[该类型的内容暂不支持下载]**

**剧情**

- ~~撰写主线剧情大纲@Serein@龚政涛@Jade⏰2024-12-09 08:00~~
- ~~完善主要支线剧情大纲@龚政涛@Serein@Jade⏰2024-12-09 08:00~~
- ~~基于剧情大纲，完成剧情结构思维导图@肇国亨~~

**v0.0.3记录**

**12/18**

**角色**

武器切换问题很大：

1. 需要解决第一发远程武器一定会偏移的问题
2. 需要解决近战武器攻击到一半，如果按下切换按键或者攻击按键可以切成其他武器的问题

**AI**

1. 需要Boss AI
2. 需要处理AI在不同技能情况下的逻辑差异

**技能**

**关卡评价**

**整体**

- 每关敌人太少，但如果方更多又会太聚集，需要补充敌人的机制
- 关卡数量本身也太少

**LV-回廊**

- 无法前往空房间有些没有必要
- 缺少大的战斗空间
- 回型结构缺乏引导：我们前往下一层的电梯门样式要更清晰

**LV-半坡阳台**

- 缺少一个陷阱房间

**12/12**

- 二级属性的

冲锋枪/步枪

手枪

狙击枪

火焰喷射器

激光枪

火箭筒

机关枪

![...](../跃入迷城%20-%20子版本规划/images/v0.0.3.025.jpeg)

**点击图片可查看完整电子表格**

**12/11**

**现状**

- 霰弹枪需要根据弹丸造成1/N的冲击伤害
- 新的冲击事件暂不实装，观察
- 击中目标的VFX特效调小一点
- 给牵引打击加一个VFX，用于后续的AI技能测试

**BUILD**

- 针对单动多发武器（如霰弹枪），策划直接在武器系数里考虑进初始多发弹丸数量
- 这样可以直接实现子弹数量追加的功能
- 对于韧性削减，也直接配置每发子弹的削减值
- 冲击事件每发子弹单独触发

**12/4**

**射击功能**

![...](../跃入迷城%20-%20子版本规划/images/v0.0.3.026.jpeg)

- 目前敌人和玩家的射击各自存在诡异的视觉引导问题：
- 在敌人瞄准时，武器和人看起来不匹配

**[12月4日.mp4]**

- 在玩家射击时，音效、弹道轨迹VFX和实际攻击行为不匹配
- 弹道轨迹和音效出现都太晚，远晚于按下鼠标输入的时间点
- 在玩家瞄准时，武器和弹道看起来不匹配
- 下图中：红色实线是（我认为）玩家能接受的弹道；红色虚线是玩家视觉中心到鼠标的连线；蓝色是武器指向的延长线，绿色是实际弹道
- 我们至少应该做到：红色实线和绿线重合，并尽量让蓝线和红色实线平行、红色虚线和红色实线平行
- 下图是受到“子弹散布”和“移动”双重干扰的极端case，但即使是静态，我们的射击弹道体验也不算理想

![...](../跃入迷城%20-%20子版本规划/images/v0.0.3.018.jpeg)

- 下图是一个理想视角（枪朝下）的静态射击演示，可以看到红色虚线和红色实线的夹角，以及蓝线和红线的夹角带来的攻击动画视觉问题。

![...](../跃入迷城%20-%20子版本规划/images/v0.0.3.018.jpeg)

- 该问题明显影响游戏手感，我有以下几个思路解决该问题
- 通用方案：
- 增加瞄准红外线，引导视觉
- 针对玩家：常驻
- 针对敌人：仅在攻击前{X}秒显示，也作为攻击提示
- 红外线停止在射程范围极限，如果首先碰撞到会阻挡子弹的目标，则停止在目标位置
- 用于提醒瞄准是否精准
- 红外线的阻挡关系应该与可见的Mesh而不是胶囊/碰撞体关联
- 红外线从子弹生成点发出，朝向射击目标点，无论生成点是否与枪口相关，以及目标点是否与鼠标位置相关（不考虑子弹散布导致的偏差）
- 在脚下增加指示攻击方向的标识圈
- 额外的专用方案 1：
- 武器和子弹生成位置脱钩，与胶囊体做相对绑定
- 这可能导致所有激光类武器都**无法实现**，so我不是很建议
- 武器的前端朝向与动画脱钩，做IK处理
- IK的定轴是右手掌心 or 右肩，待定
- 让远程武器的“枪口”永远朝向鼠标与地面形成的垂线，同时与地面平行，生成一条虚拟**指向线**
- 射击时从胶囊体生成子弹的固定位置，沿该**指向线**射击
- 参考案例：
- 额外的专用方案 2：
- 子弹依旧在枪口生成
- 鼠标CAST RAY到屏幕空间内，如果Cast到Character，返回与其Mesh/胶囊体的**交点**
- 让远程武器的“枪口”永远朝向该交点，射击时往该**交点**射击
- 如果交点不存在，则可以朝向一个虚拟**交点**，或者在场景里增加一个定高（比如120cm高）的低优先级Plane和鼠标的Ray相交
- 武器需要**瞬间**切换到正确位置，或者在到位前**block攻击输入**
- 参考案例：警区、上行战场
- 两个方案也许可以部分融合，但都应该结合通用方案使用
- **上行战场的方案**其实很值得我们参考@Decay
- 使用罗盘引导角色方向视觉
- 使用激光引导射击方向视觉
- 激光从胶囊体而非武器发射口出现
- 激光在刚出现的位置渐隐，减少错位的异样感
- 激光和鼠标“不完全”匹配位置，只是作为方向引导
- 武器非射击时，枪口指向激光位置，减少武器模型与瞄准方向的错位
- 射击时，从枪口射向激光与目标的交点（而非鼠标与目标的交点，或者固定方向）
- 武器可以精准射击到激光指示的位置额外
- 激光和重武器一样可用
- 不存在从固定位置生成子弹的异样感
- 关于**切换武器**：上行战场做了3个处理，1是切换武器非常非常快，2是切换期间应该是block了攻击输入的（我尽量测试了）3是武器是从背后从上往下切换出来的，不会出现水平面偏移，看起来影响会少很多
- 关于**枪械动画IK**：我估计以上行战场的规格，肯定是对应武器做了对应动画的，我目前观察他们至少没有针对交点处理IK（但还是处理了IK，不知道为什么，挺明显的，武器会看起来在空中更稳定，而人动来动去。可能是希望大部分武器停留在相对稳定的位置？）
- 我们的case来说，大可一把把调整武器自身的旋转以解决该问题，或者做一个与交点无关、仅用于简化手动旋转的IK，固定武器的位置（我怀疑上行战场就是为了这个目的才做的IK）
- 关于**最小对焦距离**：出于简单的三角几何，如果玩家举例瞄准目标很近，显然子弹会有一个很明显的下倾斜，才能击中激光指向的目标。事实上上行战场也没有处理这个问题，但依旧体验很好，因为：
- 武器和激光的高度相对接近，这个最小对焦距离要非常小
- 子弹的VFX足够炫，玩家不太有机会看到清晰的弹道线，只会受到精准打击的反馈
- 大部分情况下玩家会在该距离切换近战武器
- And yes，即使是上行战场，也会有这个下坠

**[12月4日(1).mp4]**

**装备功能**

**关卡功能**

**SFX**

**VFX**

**v0.0.3总结**

**新增**

**AI**

1. 大幅优化了AI的行为表现
2. 开发中：追加了

**优化**

**动画**

1. 切换到Lyra动画，大幅优化了动画表现和操作手感

**调整**

**操作**

1. 翻滚现在切换为了冲刺，以提供更好的手感和动画
2. 移除了蹲伏功能
3. 移除了武器切换，玩家现在通过对应的攻击操作，可以直接触发对应武器的攻击
1. 参考哈迪斯、Redacted等游戏
4. 开发中：追加了[v0.0.3](https://dikpa4hrtn9.feishu.cn/wiki/AtRFwyLvmiSmSAkA1P7cA0u2nXc#share-SAb5dQtYeogKEwx8pVlcDBV8nPc)韧性&硬直系统

**装备**

1. 现在玩家固定可以拥有4个武器：
1. 鼠标左键=远程攻击
2. 鼠标右键=近战攻击
3. 键盘E=投掷物
4. 键盘Q=技能
2. 大幅简化了武器和义体，及其Build结构
1. 武器：
1. 现在武器只提供基于伤害的补正和武器性能（射速、弹容量等）但依旧可以在游戏中更换
2. 武器基础伤害统一，升级提供额外的补正
3. 现在武器的属性提供更直白的效果
1. 动能：无特殊效果
2. 电磁：待开发，减速
1. 每层BUFF**重置**计时，不可叠加
3. 热能：待开发，造成持续伤害
1. 造成额外{20%}的持续伤害
2. 每层BUFF**单独**计时，可叠加
4. 辐射：待开发，造成无视
5. 纳米：待开发，造成过量伤害
1. 伤害的{50%}转为持续伤害，DEBUFF的持有者死亡后，DEBUFF转移到最近的敌对对象
2. 每层BUFF**重置**计时，可叠加
2. 义体：
1. 现在义体和技能一对一对应，均为被动，相当于哈迪斯中的祝福奖励，并且同样有一些部位限制
2. 升级提供额外的补正
1. 例如，从“造成额外{50%}武器伤害”升级为“造成额外{75%}武器伤害”
3. 移除了神经负担设计

**关卡**

1. 开发中：追加了一个Level可能刷新出多个特定关卡的功能
1. 奖励列表：[关卡设计](https://dikpa4hrtn9.feishu.cn/wiki/SBUQw11QGiUvvNkDo8OcqZNfnOe?from=from_copylink)

